@model BugTracker.Models.Tickets
<section id="ticket-comments">
    <h4>Comments for this Ticket</h4>
    @if (Model.TicketComments.Count > 0)
    {
        foreach (var comment in Model.TicketComments)
        {
            
            <div class="ticket-comment">
                <p class="ticket-comment-author">
                    @if(comment.User.inRole("Admin"))
                    {
                        <span class="admin">Admin</span>
                    }

                    @if (Model.Project.ManagerId == comment.UserId)
                    {
                        <span class="pm">PM</span>
                    }

                    @if (comment.User.IsDev())
                    {
                        <span class="dev">Dev</span>
                    }

                    @if (Model.OwnerUserId == comment.UserId)
                    {
                        <span class="submitter">Submitter</span>
                    }

                    @comment.User.Displayname said:
                </p>
                <p class="ticket-comment-body">@comment.Comment</p>
                <p class="ticket-comment-date">@comment.Created</p>
            </div>
        }
    }
    else
    {
        <h4>No commments for this ticket</h4>
    }
    <div>
        @if (ViewBag.CommentAttachmentRights)
        {
            <span>Leave a comment:</span>
            using (Html.BeginForm("LeaveComment", "TicketComments"))
            {
                @Html.AntiForgeryToken();

            <input type="hidden" name="ticketId" value="@Model.Id" />
            @Html.TextArea("commentText", new { @required = true })
            <input type="submit" class="form-control" value="Leave Comment" />
            }
        }
        else
        {
            <h4 class="alert">Contact Admin or Project Manager for permission to leave comments.</h4>
        }
    </div>
</section>